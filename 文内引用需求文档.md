# 文内引用功能需求文档

## 文档信息

- 作者 李伟
- 完成日期 2021-02-21
- 版本 V1.0

## 修订记录

| 作者 | 版本 | 完成日期   | 进度 |
| ---- | ---- | ---------- | ---- |
| 李伟 | V1.0 | 2021-02-21 | 初稿 |



## 功能概述

文内引用是指直接在编辑位置引用当前原文的内容，在miaowrite新版编辑器中，可以引用图/表/公式三种内容。



## 技术背景

### 专有名词

引用块：在编辑器中作为内容存在的文内引用块，包含被引用块的标识符。

被引用块：被文内引用指向的内容块。

### 技术分析

不需要引入新技术，以插件形式为新版编辑器提供文内引用的功能。



## 功能描述

文内引用功能是新版编辑器的一个编辑功能，依赖于新版编辑器本身，非独立存在。由创建文内引用和编辑文内引用两个子功能。

### 创建文内引用

#### 描述

在新版编辑器中，点击工具栏文内引用，弹出选择框，框内列出文内可以被引用的内容块。用户选择其一后，点击确定按钮。即在光标位置插入文内引用块。

#### UI图

![image-20210222142118163.png](https://i.loli.net/2021/02/22/EJGoRkZSfYp2L3H.png)

#### 功能点列表

1. 点击工具栏弹出的选择框
2. 选择框内包含原文内所有图表公式的引用列表

### 编辑文内引用

#### 描述

新版编辑器中，插入文内引用后，将光标定位到文内引用后方，按下BackSpace键即可删除整个引用块。点击被引用标识，即可跳转到被引用块位置。

#### UI图

![image-20210222141917156.png](https://i.loli.net/2021/02/22/T4d1M9UjxXmJ3ps.png)

#### 功能点

1. 引用块不可编辑
2. 引用块必须被整体删除
3. 点击被引用标识将跳转到引用块。



## 注意事项

1. 收集被引用块时的性能问题
2. 被引用块被删除后仍然存在的引用块的处理



## 可优化功能

暂无